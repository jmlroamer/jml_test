<!DOCTYPE html>
<html lang="en">

	<head>
		<meta charset="UTF-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<meta name="referrer" content="never">
		<title>webplayer</title>
		<script src="./h5player.min.js"></script>
		<style type="text/css">
			html,
			body {
				/* width: 100%; */
				/* height: 100%; */
				margin: auto;
				overflow: hidden;
				background-color: #fff;
				-webkit-user-select: none;
				user-select: none;
			}
		</style>
	</head>

	<body>
		<div class="container">
			<div id="play_window" class="myplayer"> </div>
		</div>

		<script>
			//取url中的参数值
			function GetQueryString(name) {
				var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)", "i");

				var r = window.location.search.substr(1).match(reg);
				if (r != null) return unescape(r[2]);
				return null;
			}

			// 初始化插件
			var myPlugin = new JSPlugin({
				szId: 'play_window', //需要英文字母开头 必填
				szBasePath: './', // 必填,引用H5player.min.js的js相对路径
				openDebug: true,
			})

			// 获取视频播放流
			var playURL = GetQueryString("cameraUrl")
			console.log(playURL);
			// 有视频流地址以后，才进行播放
			if (playURL) {
				// 窗口下标
				var curIndex = 0;
				// 获取监控点唯一标识，方便作为抓图存储的key
				var cameraIndexCode = GetQueryString("cameraIndexCode")
				// 视频预览
				myPlugin.JS_Play(playURL, {
					playURL,
					mode: 1
				}, curIndex).then(() => {
					console.info('JS_Play success 播放成功');
					// do you want...
					// 抓图
					// var fileName = 'img';
					// var fileType = 'JPEG';
					// //不进行下载，数据回调
					// myPlugin.JS_CapturePicture(curIndex, fileName, fileType, imageData => {
					// 	console.info('JS_CapturePicture success 抓图成功'); //2.1.0开始全是base64，之前的版本存在blob或者是base64
					// 	// do you want...
					// 	plus.storage.setItem(cameraIndexCode, imageData);
					// })
				}, (err) => {
					console.info('JS_Play failed:', err);
					// do you want...
				});
			} else {
				console.log('未获得地址，不播放');
			}
		</script>
	</body>

</html>